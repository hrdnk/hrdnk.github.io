<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    

    <div class="slider">
        <div class="pagination">
          <div class="pagination__track">
          </div>
        </div>
      
        <div class="slides">
          <div class="slide">
            <div class="slide__pagination-label">
              <div class="circle"></div>
              <span>2021</span>
            </div>
            <div class="slide__content">
              <div class="slide__title">today</div>
              <div class="slide__text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsam officiis consequuntur omnis, quae impedit</div>
            </div>
          </div>
          
          <div class="slide">
            <div class="slide__pagination-label">
              <span>2017</span>
            </div>
            <div class="slide__content">
              <div class="slide__title">2017</div>
              <div class="slide__text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsam officiis consequuntur omnis, animi sunt ut maiores eos aliquid repudiandae tempore eum, quaerat perferendis iste.</div>
            </div>
          </div>
          
          <div class="slide">
            <div class="slide__pagination-label">
              <span>2015</span>
            </div>
            <div class="slide__content">
              <div class="slide__title">2015</div>
              <div class="slide__text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsam officiis consequuntur omnis, quaerat perferendis iste.</div>
            </div>
          </div>
          
          <div class="slide">
            <div class="slide__pagination-label">
              <span>2012</span>
            </div>
            <div class="slide__content">
              <div class="slide__title">2012</div>
              <div class="slide__text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsam officiis consequuntur omnis, animi sunt ut maiores eos aliquid repudiandae tempore eum</div>
            </div>
          </div>
          
          <div class="slide">
            <div class="slide__pagination-label">
              <span>2011</span>
            </div>
            <div class="slide__content">
              <div class="slide__title">2011</div>
              <div class="slide__text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsam officiis consequuntur omnis, quae impedit nihil suscipit reprehenderit eveniet, animi sunt ut maiores eos aliquid repudiandae tempore eum, quaerat perferendis iste.</div>
            </div>
          </div>
          
          <div class="slide">
            <div class="slide__pagination-label">
              <span>2007</span>
            </div>
            <div class="slide__content">
              <div class="slide__title">2007</div>
              <div class="slide__text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsam officiis consequuntur omnis, quae impedit nihil suscipit reprehenderit eveniet, animi sunt ut maiores eos aliquid repudiandae tempore eum, quaerat perferendis iste.</div>
            </div>
          </div>
          
          <div class="slide">
            <div class="slide__pagination-label">
              <span>2006</span>
            </div>
            <div class="slide__content">
              <div class="slide__title">2006</div>
              <div class="slide__text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsam officiis consequuntur omnis, quae impedit nihil suscipit reprehenderit eveniet, animi sunt ut maiores eos aliquid repudiandae tempore eum, quaerat perferendis iste.</div>
            </div>
          </div>
          
          <div class="slide">
            <div class="slide__pagination-label">
              <span>2004</span>
            </div>
            <div class="slide__content">
              <div class="slide__title">2004</div>
              <div class="slide__text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsam officiis consequuntur omnis, quae impedit nihil suscipit reprehenderit eveniet, animi sunt ut maiores eos aliquid repudiandae tempore eum, quaerat perferendis iste.</div>
            </div>
          </div>
          
          <div class="slide">
            <div class="slide__pagination-label">
              <span>2001</span>
            </div>
            <div class="slide__content">
              <div class="slide__title">2001</div>
              <div class="slide__text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsam officiis consequuntur omnis, quae impedit nihil suscipit reprehenderit eveniet, animi sunt ut maiores eos aliquid repudiandae tempore eum, quaerat perferendis iste.</div>
            </div>
          </div>
          
        </div>
      </div>
      
      <div class="buttons">
        <button id="prev">prev</button>
        <button id="next">next</button>
      </div>

    <script>
        const sliderEl = document.querySelector('.slider');
        const slideEls = sliderEl.querySelectorAll('.slide');
        const paginationTrackEl = sliderEl.querySelector('.pagination__track');
        const rotateStep = 10;

        let currentSlideIdx = 2;

        function initSlider() {
        const pagLabelsEls = sliderEl.querySelectorAll('.slide__pagination-label');
        for (let i = 0; i < pagLabelsEls.length; i++) {
            const lab = pagLabelsEls[i];
            const clone = lab.cloneNode(true);
            clone.classList.remove('slide__pagination-label');
            clone.classList.add('pagination__item');
            clone.dataset.index = i;
            clone.style.transform = `rotate(${i * rotateStep}deg)`;
            paginationTrackEl.appendChild(clone);
        }
        
        for (let i = 0; i < slideEls.length; i++) {
            const slide = slideEls[i];
            slide.style.left = `${i * -100}%`;
        }
        
        slideEls[currentSlideIdx].classList.add('slide--active');
        paginationTrackEl.style.transform = `rotate(${currentSlideIdx * -rotateStep}deg)`;
        onNextFrame(() => paginationTrackEl.classList.add('pagination__track--transition'));
        }

        initSlider();

        function slideTo(index) {
        const totalSlides = slideEls.length;
        const nextIndex = ((index % totalSlides) + totalSlides) % totalSlides;

        if (nextIndex === currentSlideIdx) return;

        const current = slideEls[currentSlideIdx];
        const next = slideEls[nextIndex];
        
        current.classList.replace('slide--active', 'slide--next');
        current.classList.add('slide--transition');

        current.addEventListener('transitionend', () => {
            current.classList.remove('slide--next');
            current.classList.remove('slide--transition');
        }, { once: true });

        next.classList.add('slide--active', 'slide--transition');

        paginationTrackEl.style.transform = `rotate(${nextIndex * -rotateStep}deg)`;
        
        currentSlideIdx = nextIndex;
        }

        const next = document.getElementById('next');
        const prev = document.getElementById('prev');
        next.addEventListener('click', () => {
        slideTo(currentSlideIdx + 1);
        });

        prev.addEventListener('click', () => {
        slideTo(currentSlideIdx - 1);
        });

        sliderEl.addEventListener('click', ({ target }) => {
        const pagItemEl = target.closest('.pagination__item');
        if (!pagItemEl) return;
        
        const idx = Number(pagItemEl.dataset.index);
        slideTo(idx);
        });

        // utils

        function onNextFrame(cb) {
        requestAnimationFrame(() => requestAnimationFrame(cb));
        }

    </script>
</body>
</html>